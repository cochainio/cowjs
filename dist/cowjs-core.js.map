{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./src/cowjs-core/network.ts","webpack:///./src/cowjs-core/plugin.ts","webpack:///./src/cowjs-core/plugin-repository.ts","webpack:///./src/cowjs-core/error.ts","webpack:///./src/cowjs-core/service.ts","webpack:///./src/cowjs-core/index.ts"],"names":["root","factory","exports","module","define","amd","a","i","window","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Network","this","port","placeholder","fromJSON","json","assign","url","protocol","host","clone","JSON","parse","stringify","isValid","length","chainID","Plugin","fromJson","plugin_repository","PluginRepositorySingleton","plugins","loadPlugin","plugin","push","find","supportedBlockchains","map","_super","CowError","code","message","_this","Error","captureStackTrace","__extends","toString","service","Service","callback","method","methodID","response","console","log","callAwaits","has","_a","__read","resolve","reject","delete","rep","error","msg","warn","args","timeout","cochain","Promise","exec","setTimeout","set","Map","cowjs_core_Cow","Cow","signatureProvider","hookProvider","getWallets","blockchain","sent","getCurrentWallet","shareSNS","title","desc","image","sign","data","whatFor","isHash","__webpack_exports__"],"mappings":"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","file":"cowjs-core.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 15);\n","export default class Network {\r\n    static placeholder () { return new Network() }\r\n\r\n    static fromJSON (json: object) {\r\n        return Object.assign(Network.placeholder(), json)\r\n    }\r\n\r\n    name: string\r\n    protocol: string\r\n    host: string\r\n    port: number = 0\r\n    blockchain: string\r\n    chainID: string\r\n\r\n    url () {\r\n        return `${this.protocol}://${this.host}` + (this.port > 0 ? `:${this.port}` : '')\r\n    }\r\n\r\n    clone () {\r\n        return Network.fromJSON(JSON.parse(JSON.stringify(this)))\r\n    }\r\n\r\n    isValid () {\r\n        return (this.protocol.length && this.host.length && this.port) || this.chainID.length\r\n    }\r\n}\r\n","export default class Plugin {\r\n    static placeholder () {\r\n        return new Plugin()\r\n    }\r\n\r\n    static fromJson (json: object) {\r\n        return Object.assign(Plugin.placeholder(), json)\r\n    }\r\n\r\n    constructor (public name = '') {}\r\n}\r\n","import Plugin from './plugin'\r\n\r\nexport class PluginRepositorySingleton {\r\n    plugins: Plugin[] = []\r\n\r\n    loadPlugin (plugin: Plugin) {\r\n        if (!this.plugin(plugin.name)) {\r\n            this.plugins.push(plugin)\r\n        }\r\n    }\r\n\r\n    plugin (name: string) {\r\n        return this.plugins.find(plugin => plugin.name === name)\r\n    }\r\n\r\n    supportedBlockchains (): string[] {\r\n        return this.plugins.map(plugin => plugin.name)\r\n    }\r\n}\r\n\r\nconst PluginRepository = new PluginRepositorySingleton()\r\nexport default PluginRepository\r\n","export default class CowError extends Error {\r\n    name = 'CowError'\r\n\r\n    constructor (public code: number, public message: string) {\r\n        super(message)\r\n\r\n        if (Error.captureStackTrace) {\r\n            Error.captureStackTrace(this, CowError)\r\n        }\r\n    }\r\n\r\n    toString (): string {\r\n        return `${this.name}: < code: ${this.code}, message: ${this.message} >`\r\n    }\r\n}\r\n","import CowError from './error'\r\n\r\nexport default class Service {\r\n    static callback (method: string, methodID: number, response: string) {\r\n        (console as any).log(method, methodID, JSON.parse(response))\r\n\r\n        if (!Service.callAwaits.has(methodID)) {\r\n            console.warn(`call id ${methodID} not found`)\r\n            return\r\n        }\r\n        const [ resolve, reject ] = Service.callAwaits.get(methodID)\r\n        Service.callAwaits.delete(methodID)\r\n\r\n        const rep = JSON.parse(response)\r\n        if (rep.code) { // failed\r\n            reject(new CowError(rep.code, rep.msg))\r\n        } else { // succeeded\r\n            resolve(rep)\r\n        }\r\n    }\r\n\r\n    static async call (method: string, args: object, timeout: number = 120000) { // default timeout is 120s\r\n        // Lazily set callback\r\n        if (!(window as any).cochain.callback) {\r\n            (window as any).cochain.callback = Service.callback\r\n        }\r\n\r\n        return new Promise((resolve, reject) => {\r\n            const methodID = (window as any).cochain.exec(JSON.stringify({\r\n                method,\r\n                args\r\n            }))\r\n\r\n            if (Service.callAwaits.has(methodID)) {\r\n                reject(new CowError(1, 'inconsistent remote exec'))\r\n            }\r\n\r\n            setTimeout(() => {\r\n                if (Service.callAwaits.has(methodID)) {\r\n                    reject(new CowError(1, 'timeout'))\r\n                    Service.callAwaits.delete(methodID)\r\n                }\r\n            }, timeout)\r\n\r\n            Service.callAwaits.set(methodID, [resolve, reject])\r\n        })\r\n    }\r\n\r\n    private static callAwaits = new Map<number, [any, any]>()\r\n}\r\n","import Network from './network'\r\nimport Plugin from './plugin'\r\nimport PluginRepository from './plugin-repository'\r\nimport Service from './service'\r\n\r\nexport { Network, Plugin, Service }\r\n\r\nclass Cow {\r\n    loadPlugin (plugin: Plugin) {\r\n        PluginRepository.loadPlugin(plugin)\r\n\r\n        Object.assign(this, {\r\n            [plugin.name]: (plugin as any).signatureProvider(),\r\n            [plugin.name + 'Hook']: (plugin as any).hookProvider\r\n        })\r\n    }\r\n\r\n    supportedBlockchains (): string[] {\r\n        return PluginRepository.supportedBlockchains()\r\n    }\r\n\r\n    // Get all wallets of specified blockchain type or all blockchain types\r\n    async getWallets (blockchain?: string) {\r\n        return await Service.call('getWallets', {\r\n            blockchain\r\n        })\r\n    }\r\n\r\n    async getCurrentWallet () {\r\n        return await Service.call('getCurrentWallet', {})\r\n    }\r\n\r\n    async shareSNS (title: string, desc: string, url: string, image: string) {\r\n        return await Service.call('shareSNS', {\r\n            title, desc, url, image\r\n        })\r\n    }\r\n\r\n    // Sign arbitrary data using private key of current wallet\r\n    async sign (data: string, whatFor: string = '', isHash: boolean = false) {\r\n        return await Service.call('sign', {\r\n            data,\r\n            whatFor,\r\n            isHash\r\n        })\r\n    }\r\n\r\n    /*\r\n    async getPublicKey (blockchain: string) {\r\n        return await Service.call('getPublicKey', {\r\n            blockchain\r\n        })\r\n    }\r\n    */\r\n}\r\n\r\nexport default new Cow()\r\n"],"sourceRoot":""}